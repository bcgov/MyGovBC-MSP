<ng-content select="[sectionTitleInfo]"></ng-content>
<common-page-section layout="tips">
  <div *ngIf="isCanadianNotBC">
    <div class="form-group p-sm-2">
      <common-radio name="livedInBCSinceBirth_{{objectId}}"
                    [(ngModel)]="person.livedInBCSinceBirth"  
                    label="Have {{relationship}} lived in B.C. since birth?" 
                    required>
      </common-radio>
    </div>
  </div>

  <div *ngIf="isCanadianFromProv || isCanadianFromCountry || (isCanadianNotBC && person.livedInBCSinceBirth)">
    <div class="form-group p-sm-2">
      <common-radio name="madePermanentMoveToBC_{{objectId}}"
                    [(ngModel)]="person.madePermanentMoveToBC"  
                    label="Have {{relationship}} moved to B.C. permanently?" 
                    required>
      </common-radio>
      <common-error-container [displayError]="person.madePermanentMoveToBC == false">
        You have indcated that a recent move to B.C. is not permanent.  As a result, this person
        is not eligible for enrolment in the Medical Services Plan.  Please contact
        <a href="{{links.MSP_RESIDENT_CONTACT}}" target="_blank">Health Insurance BC</a> for further 
        information.
      </common-error-container>
    </div>

    <div *ngIf="isCanadianFromProv || isCanadianNotBC; else SelectCountry"
         class="form-group col-sm-6 p-sm-2">
      <common-province name="movedFromProvince_{{objectId}}"
                       label="Which province are {{relationship}} moving from?"
                       [provinceList]="provinceList"
                       [(ngModel)]="person.movedFromProvinceOrCountry"
                       required>
      </common-province>
    </div>

    <div *ngIf="isCanadianFromProv || isCanadianFromCountry; else NewToBC"
         class="form-group col-sm-6 p-sm-2">
        <common-date label="Arrival date in B.C."
                     [restrictDate]="'past'" 
                     [(date)]="person.arrivalToBCSimple"
                     [required]="true">
        </common-date>
    </div>

    <div class="form-group col-sm-6 p-sm-2">
      <common-date label="Arrival date in Canada{{!isCanadianFromCountry ? ' (optional)' : ''}}"
                    [restrictDate]="'past'" 
                    [(date)]="person.arrivalToCanadaDate"
                    [required]="isCanadianFromCountry">
      </common-date>
    </div>

    <div *ngIf="isCanadianFromProv" class="form-group col-sm-6 p-sm-2">
      <common-phn name="healthNumber_{{objectId}}"
                  label="Health Number from that province (optional)"
                  [(ngModel)]="person.healthNumberFromOtherProvince"
                  commonValidatePhn
                  [isBCPhn]="false">
      </common-phn>
    </div>
  </div>

  <div *ngIf="isCanadianFromProv || isCanadianFromCountry || (isCanadianNotBC && person.livedInBCSinceBirth !== undefined)">
    <div class="form-group p-sm-2">
      <common-radio name="outsideOver30Days_{{objectId}}"
                    [(ngModel)]="person.declarationForOutsideOver30Days"  
                    label="Have {{relationship}} been outside B.C. for more than 30 days in total in the past 12 months?" 
                    required>
      </common-radio>
    </div>
    <div *ngIf="person.declarationForOutsideOver30Days" class="border-left">
      Need to add additional questions
    </div>

    <div class="form-group p-sm-2">
      <common-radio name="hasPreviousBCPhn_{{objectId}}"
                    [(ngModel)]="person.hasPreviousBCPhn"  
                    label="Do {{relationship}} have a previous B.C. Personal Health Number?" 
                    required>
      </common-radio>
    </div>

    <div *ngIf="person.hasPreviousBCPhn" class="form-group p-sm-2 border-left">
      <common-phn name="previousPhn_{{objectId}}"
                  label="{{relationship | titlecase }} previous B.C. Personal Health Number (optional)"
                  [(ngModel)]="person.previous_phn"
                  commonValidatePhn>
      </common-phn>
    </div>

    <div class="form-group p-sm-2">
      <common-radio name="armedForces_{{objectId}}"
                    [(ngModel)]="person.hasBeenReleasedFromArmedForces"  
                    label="Have {{relationship}} been released from the Canadian Armed Forces or an Institution?" 
                    required>
      </common-radio>
    </div>

    <div *ngIf="person.hasBeenReleasedFromArmedForces" class="form-group p-sm-2 border-left">
      Need to request more information
    </div>

    <div class="form-group p-sm-2">
      <common-radio name="fullTimeStudent_{{objectId}}"
                    [(ngModel)]="person.fullTimeStudent"  
                    label="Are {{relationship}} full-time student in B.C.?" 
                    required>
      </common-radio>
    </div>

    <div *ngIf="person.fullTimeStudent" class="form-group p-sm-2 border-left">
      Need to request more information
    </div>

  </div>
</common-page-section>

<ng-template #SelectCountry>
  <div class="form-group col-sm-6 p-sm-2">
    <common-country name="movedFromCountry_{{objectId}}"
                    label="Which country are {{relationship}} moving from?"
                    [countryList]="countryList"
                    [(ngModel)]="person.movedFromProvinceOrCountry"
                    required>
    </common-country>
  </div>
</ng-template>

<ng-template #NewToBC>
  <div class="form-group col-sm-6 p-sm-2">
    <common-date label="Most recent move to B.C."
                 [restrictDate]="'past'" 
                 [(date)]="person.arrivalToBCSimple"
                 [required]="true">
    </common-date>
  </div>
</ng-template>